let mouseoverTimer,lastTouchTimestamp;const prefetches=new Set,isSupported=document.createElement("link").relList.supports("prefetch"),allowQueryString="instantAllowQueryString"in document.body.dataset,allowExternalLinks="instantAllowExternalLinks"in document.body.dataset,useWhitelist="instantWhitelist"in document.body.dataset,mousedownShortcut="instantMousedownShortcut"in document.body.dataset,DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION=1111;let delayOnHover=65,useMousedown=!1,useMousedownOnly=!1,useViewport=!1,chromiumMajorVersionClientHint=null;if(navigator.userAgentData&&navigator.userAgentData.brands.forEach((({brand:e,version:t})=>{"Chromium"===e&&(chromiumMajorVersionClientHint=parseInt(t))})),"instantIntensity"in document.body.dataset){const e=document.body.dataset.instantIntensity;if(e.startsWith("mousedown"))useMousedown=!0,"mousedown-only"===e&&(useMousedownOnly=!0);else if(e.startsWith("viewport"))navigator.connection&&(navigator.connection.saveData||navigator.connection.effectiveType&&navigator.connection.effectiveType.includes("2g"))||("viewport"===e?document.documentElement.clientWidth*document.documentElement.clientHeight<45e4&&(useViewport=!0):"viewport-all"===e&&(useViewport=!0));else{const t=parseInt(e);isNaN(t)||(delayOnHover=t)}}if(isSupported){const e={capture:!0,passive:!0};if(useMousedownOnly||document.addEventListener("touchstart",touchstartListener,e),useMousedown?mousedownShortcut||document.addEventListener("mousedown",mousedownListener,e):document.addEventListener("mouseover",mouseoverListener,e),mousedownShortcut&&document.addEventListener("mousedown",mousedownShortcutListener,e),useViewport){let e=window.requestIdleCallback;e||(e=e=>{e()}),e((function(){const e=new IntersectionObserver((t=>{t.forEach((t=>{if(t.isIntersecting){const o=t.target;e.unobserve(o),preload(o.href)}}))}));document.querySelectorAll("a").forEach((t=>{isPreloadable(t)&&e.observe(t)}))}),{timeout:1500})}}function touchstartListener(e){lastTouchTimestamp=performance.now();const t=e.target.closest("a");isPreloadable(t)&&preload(t.href,"high")}function mouseoverListener(e){if(performance.now()-lastTouchTimestamp<1111)return;if(!("closest"in e.target))return;const t=e.target.closest("a");isPreloadable(t)&&(t.addEventListener("mouseout",mouseoutListener,{passive:!0}),mouseoverTimer=setTimeout((()=>{preload(t.href,"high"),mouseoverTimer=void 0}),delayOnHover))}function mousedownListener(e){const t=e.target.closest("a");isPreloadable(t)&&preload(t.href,"high")}function mouseoutListener(e){e.relatedTarget&&e.target.closest("a")===e.relatedTarget.closest("a")||mouseoverTimer&&(clearTimeout(mouseoverTimer),mouseoverTimer=void 0)}function mousedownShortcutListener(e){if(performance.now()-lastTouchTimestamp<1111)return;const t=e.target.closest("a");if(e.which>1||e.metaKey||e.ctrlKey)return;if(!t)return;t.addEventListener("click",(function(e){1337!==e.detail&&e.preventDefault()}),{capture:!0,passive:!1,once:!0});const o=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1,detail:1337});t.dispatchEvent(o)}function isPreloadable(e){if(e&&e.href&&(!useWhitelist||"instant"in e.dataset)){if(e.origin!==location.origin){if(!(allowExternalLinks||"instant"in e.dataset||e.host.endsWith("solo.to"))||!chromiumMajorVersionClientHint)return}if(["http:","https:"].includes(e.protocol)&&("http:"!==e.protocol||"https:"!==location.protocol)&&(allowQueryString||!e.search||"instant"in e.dataset)&&(!e.hash&&!e.href.endsWith("#")||e.pathname+e.search!==location.pathname+location.search)&&!("noInstant"in e.dataset))return!0}}function preload(e,t="auto"){if(prefetches.has(e))return;const o=document.createElement("link");o.rel="prefetch",o.href=e,o.fetchPriority=t,o.as="document",document.head.appendChild(o),prefetches.add(e)}
